<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Mobile Pastel Slime Studio</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@700&display=swap" rel="stylesheet" />
    <style>
      body {
        margin: 0;
        padding: 0;
        overflow: hidden;
        background: #fdfcfb;
        font-family: "Quicksand", sans-serif;
        touch-action: none;
        user-select: none;
      }

      canvas {
        display: block;
        touch-action: none;
      }

      .back-link {
        position: fixed;
        top: 12px;
        left: 12px;
        z-index: 20;
        text-decoration: none;
        color: #334155;
        font-size: 0.8rem;
        background: rgba(255, 255, 255, 0.92);
        border: 1px solid #e2e8f0;
        border-radius: 999px;
        padding: 0.35rem 0.7rem;
      }

      .title-wrap {
        position: absolute;
        top: 32px;
        width: 100%;
        text-align: center;
        pointer-events: none;
      }

      .title {
        margin: 0;
        color: #94a3b8;
        font-size: 1.25rem;
      }

      .subtitle {
        margin: 0.2rem 0 0;
        color: #cbd5e1;
        font-size: 0.75rem;
      }

      .ui-container {
        position: absolute;
        bottom: 20px;
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 12px;
        pointer-events: none;
      }

      .panel {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        padding: 12px;
        border-radius: 24px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        border: 1px solid rgba(255, 255, 255, 0.8);
        display: flex;
        gap: 8px;
        pointer-events: auto;
        max-width: 95vw;
      }

      .palette-panel {
        width: min(320px, 95vw);
      }

      .color-scroll {
        overflow-x: auto;
        white-space: nowrap;
        display: flex;
        gap: 12px;
        padding: 4px 8px;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: thin;
        scrollbar-color: #f472b6 transparent;
      }

      .color-scroll::-webkit-scrollbar {
        height: 4px;
      }

      .color-scroll::-webkit-scrollbar-thumb {
        background: #f472b6;
        border-radius: 10px;
      }

      .btn {
        padding: 10px 14px;
        border-radius: 16px;
        border: 0;
        font-size: 0.7rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        transition: all 0.2s;
        background: #f1f5f9;
        color: #64748b;
        flex-shrink: 0;
      }

      .btn.active {
        background: #f472b6;
        color: white;
        box-shadow: 0 4px 10px rgba(244, 114, 182, 0.3);
      }

      .color-dot {
        width: 34px;
        height: 34px;
        border-radius: 50%;
        cursor: pointer;
        border: 3px solid white;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        flex-shrink: 0;
      }

      .color-dot:active {
        transform: scale(0.9);
      }
    </style>
  </head>
  <body>
    <a class="back-link" href="../../index.html">‚Üê Back to all apps</a>

    <div class="title-wrap">
      <h1 class="title">Tactile Studio üé®</h1>
      <p class="subtitle">Swipe colors &amp; mold the slime ‚ú®</p>
    </div>

    <canvas id="slimeCanvas"></canvas>

    <div class="ui-container">
      <div class="panel">
        <button onclick="setType('jiggly')" id="b-jiggly" class="btn active">Jiggly</button>
        <button onclick="setType('butter')" id="b-butter" class="btn">Butter</button>
        <button onclick="setType('floam')" id="b-floam" class="btn">Floam</button>
        <button onclick="setType('icee')" id="b-icee" class="btn">Icee</button>
      </div>

      <div class="panel palette-panel">
        <div class="color-scroll">
          <div class="color-dot" style="background: #FFB7B2;" onclick="setColor('#FFB7B2')"></div>
          <div class="color-dot" style="background: #FFDAC1;" onclick="setColor('#FFDAC1')"></div>
          <div class="color-dot" style="background: #E2F0CB;" onclick="setColor('#E2F0CB')"></div>
          <div class="color-dot" style="background: #B5EAD7;" onclick="setColor('#B5EAD7')"></div>
          <div class="color-dot" style="background: #C7CEEA;" onclick="setColor('#C7CEEA')"></div>
          <div class="color-dot" style="background: #F3E5F5;" onclick="setColor('#F3E5F5')"></div>
          <div class="color-dot" style="background: #E0F7FA;" onclick="setColor('#E0F7FA')"></div>
          <div class="color-dot" style="background: #FFF9C4;" onclick="setColor('#FFF9C4')"></div>
          <div class="color-dot" style="background: #FFE0B2;" onclick="setColor('#FFE0B2')"></div>
          <div class="color-dot" style="background: #F8BBD0;" onclick="setColor('#F8BBD0')"></div>
          <div class="color-dot" style="background: #D1C4E9;" onclick="setColor('#D1C4E9')"></div>
          <div class="color-dot" style="background: #C8E6C9;" onclick="setColor('#C8E6C9')"></div>
          <div class="color-dot" style="background: #B3E5FC;" onclick="setColor('#B3E5FC')"></div>
          <div class="color-dot" style="background: #F0F4C3;" onclick="setColor('#F0F4C3')"></div>
          <div class="color-dot" style="background: #E1BEE7;" onclick="setColor('#E1BEE7')"></div>
        </div>
      </div>
    </div>

    <script>
      const canvas = document.getElementById("slimeCanvas");
      const ctx = canvas.getContext("2d");
      let width;
      let height;

      let particles = [];
      let mouse = { x: -100, y: -100, active: false };
      let currentType = "jiggly";
      let targetColor = { r: 255, g: 183, b: 178 };
      let currentColor = { r: 255, g: 183, b: 178 };

      const config = {
        jiggly: { stiff: 0.15, fric: 0.85, push: 0.6, rad: 130 },
        butter: { stiff: 0.05, fric: 0.6, push: 0.3, rad: 150 },
        floam: { stiff: 0.004, fric: 0.25, push: 1.0, rad: 140 },
        icee: { stiff: 0.015, fric: 0.4, push: 0.8, rad: 120 },
      };

      class Particle {
        constructor(angle) {
          this.angle = angle;
          this.initBase();
          this.x = this.baseX + window.innerWidth / 2;
          this.y = this.baseY + window.innerHeight / 2;
          this.vx = 0;
          this.vy = 0;
        }

        initBase() {
          const scale = Math.min(window.innerWidth / 400, 1);
          const radius = config[currentType].rad * scale;
          this.baseX = Math.cos(this.angle) * radius;
          this.baseY = Math.sin(this.angle) * radius;
        }

        update(cx, cy) {
          const c = config[currentType];
          const dx = cx + this.baseX - this.x;
          const dy = cy + this.baseY - this.y;

          this.vx += dx * c.stiff;
          this.vy += dy * c.stiff;

          if (mouse.active) {
            const mdx = mouse.x - this.x;
            const mdy = mouse.y - this.y;
            const dist = Math.sqrt(mdx * mdx + mdy * mdy);
            const range = 90;

            if (dist < range) {
              const force = (range - dist) / range;
              this.vx -= mdx * force * c.push;
              this.vy -= mdy * force * c.push;
            }
          }

          this.vx *= c.fric;
          this.vy *= c.fric;
          this.x += this.vx;
          this.y += this.vy;
        }
      }

      function setType(type) {
        currentType = type;
        document.querySelectorAll(".btn").forEach((b) => b.classList.remove("active"));
        document.getElementById("b-" + type).classList.add("active");
        init();
      }

      function setColor(hex) {
        const r = parseInt(hex.slice(1, 3), 16);
        const g = parseInt(hex.slice(3, 5), 16);
        const b = parseInt(hex.slice(5, 7), 16);
        targetColor = { r, g, b };
      }

      function init() {
        width = canvas.width = window.innerWidth;
        height = canvas.height = window.innerHeight;
        particles = [];
        const count = 60;

        for (let i = 0; i < count; i += 1) {
          particles.push(new Particle((i / count) * Math.PI * 2));
        }
      }

      function draw() {
        ctx.clearRect(0, 0, width, height);

        currentColor.r += (targetColor.r - currentColor.r) * 0.1;
        currentColor.g += (targetColor.g - currentColor.g) * 0.1;
        currentColor.b += (targetColor.b - currentColor.b) * 0.1;

        const fillStyle = `rgb(${currentColor.r}, ${currentColor.g}, ${currentColor.b})`;
        const cx = width / 2;
        const cy = height / 2;

        particles.forEach((p) => p.update(cx, cy));

        ctx.beginPath();
        ctx.moveTo(particles[0].x, particles[0].y);

        for (let i = 0; i < particles.length; i += 1) {
          const p1 = particles[i];
          const p2 = particles[(i + 1) % particles.length];
          ctx.quadraticCurveTo(p1.x, p1.y, (p1.x + p2.x) / 2, (p1.y + p2.y) / 2);
        }

        ctx.closePath();

        ctx.shadowBlur = 30;
        ctx.shadowColor = `rgba(${currentColor.r}, ${currentColor.g}, ${currentColor.b}, 0.2)`;
        ctx.fillStyle = fillStyle;
        ctx.fill();

        ctx.shadowBlur = 0;
        ctx.beginPath();
        ctx.ellipse(cx - 50, cy - 50, 40, 15, Math.PI / 4, 0, Math.PI * 2);
        ctx.fillStyle = "rgba(255,255,255,0.15)";
        ctx.fill();

        requestAnimationFrame(draw);
      }

      function handleMove(e) {
        const clientX = e.touches ? e.touches[0].clientX : e.clientX;
        const clientY = e.touches ? e.touches[0].clientY : e.clientY;
        mouse.x = clientX;
        mouse.y = clientY;
      }

      window.addEventListener("mousedown", () => {
        mouse.active = true;
      });

      window.addEventListener("mouseup", () => {
        mouse.active = false;
      });

      window.addEventListener("mousemove", handleMove);

      window.addEventListener("touchstart", (e) => {
        if (e.target.closest("button") || e.target.classList.contains("color-dot") || e.target.closest(".back-link")) {
          return;
        }
        mouse.active = true;
        handleMove(e);
      });

      window.addEventListener("touchend", () => {
        mouse.active = false;
      });

      window.addEventListener(
        "touchmove",
        (e) => {
          if (mouse.active) {
            e.preventDefault();
            handleMove(e);
          }
        },
        { passive: false }
      );

      window.addEventListener("resize", init);

      init();
      draw();
    </script>
  </body>
</html>
